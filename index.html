<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Shivangi üíç</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,700;9..144,900&family=Inter:wght@400;600;800&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --bgA: #fff0f7;
        --bgB: #f3efff;
        --bgC: #fff8fd;

        --card: #ffffffd9;
        --stroke: #00000010;
        --shadow: 0 18px 60px rgba(20, 10, 35, 0.18);

        --text: #1b1029;
        --muted: #4b355f;
        --muted2: #6c4f86;

        --ring: rgba(255, 79, 163, 0.28);

        --yes-primary: #ff4d8f;
        --yes-secondary: #ff7aab;
        --yes-glow: rgba(255, 77, 143, 0.3);

        --no-primary: #8b7ba8;
        --no-secondary: #a695c4;

        --chefA: rgba(255, 177, 209, 0.22);
        --chefB: rgba(255, 230, 150, 0.16);
        --chefC: rgba(164, 132, 255, 0.18);
      }

      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        overflow: hidden;
        color: var(--text);
        font-family:
          Inter,
          ui-sans-serif,
          system-ui,
          -apple-system,
          Segoe UI,
          Roboto,
          Helvetica,
          Arial;

        background:
          radial-gradient(
            900px 520px at 18% 12%,
            var(--chefA),
            transparent 60%
          ),
          radial-gradient(
            980px 560px at 86% 18%,
            var(--chefC),
            transparent 60%
          ),
          radial-gradient(
            1000px 620px at 50% 92%,
            var(--chefB),
            transparent 60%
          ),
          linear-gradient(145deg, var(--bgA), var(--bgB) 45%, var(--bgC));
      }

      /* Confetti, full page */
      #confettiLayer {
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 9999;
        overflow: hidden;
      }
      .confetti {
        position: absolute;
        width: 10px;
        height: 14px;
        border-radius: 3px;
        opacity: 0.95;
        will-change: transform;
        animation: confFall var(--dur) ease-out forwards;
        box-shadow: 0 8px 18px rgba(20, 10, 35, 0.1);
      }
      @keyframes confFall {
        0% {
          transform: translate3d(var(--x), var(--y), 0) rotate(0deg);
          opacity: 1;
        }
        100% {
          transform: translate3d(
              calc(var(--x) + var(--dx)),
              calc(var(--y) + var(--dy)),
              0
            )
            rotate(var(--rot));
          opacity: 0;
        }
      }

      /* Two background layers: outlined hearts, then filled hearts (hidden until YES) */
      .heartsOutline,
      .heartsFill {
        position: fixed;
        inset: 0;
        pointer-events: none;
        background-repeat: repeat;
        background-size: 520px 520px;
        filter: blur(0.2px);
        animation: heartsFloat 14s ease-in-out infinite alternate;
      }

      .heartsOutline {
        opacity: 0.22;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='520' height='520' viewBox='0 0 520 520'%3E%3Cg fill='none' stroke='rgba(255,77,143,0.26)' stroke-width='10'%3E%3Cpath d='M260 395s-135-80-170-160c-22-50 8-110 66-120 38-7 76 10 104 45 28-35 66-52 104-45 58 10 88 70 66 120-35 80-170 160-170 160z'/%3E%3C/g%3E%3C/svg%3E");
        transition: opacity 900ms ease;
      }

      .heartsFill {
        opacity: 0;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='520' height='520' viewBox='0 0 520 520'%3E%3Cg fill='rgba(255,77,143,0.16)' stroke='rgba(255,77,143,0.18)' stroke-width='6'%3E%3Cpath d='M260 395s-135-80-170-160c-22-50 8-110 66-120 38-7 76 10 104 45 28-35 66-52 104-45 58 10 88 70 66 120-35 80-170 160-170 160z'/%3E%3C/g%3E%3C/svg%3E");
        transition:
          opacity 1000ms ease,
          filter 1000ms ease;
        filter: drop-shadow(0 0 0 rgba(255, 77, 143, 0));
      }

      body.love .heartsOutline {
        opacity: 0.1;
      }
      body.love .heartsFill {
        opacity: 0.22;
        filter: drop-shadow(0 0 18px rgba(255, 77, 143, 0.25));
      }

      @keyframes heartsFloat {
        from {
          transform: translate3d(0px, -6px, 0) scale(1.02);
        }
        to {
          transform: translate3d(0px, 8px, 0) scale(1.06);
        }
      }

      .wrap {
        height: 100%;
        display: grid;
        place-items: center;
        padding: 22px;
        position: relative;
        z-index: 1;
      }

      .card {
        width: min(920px, 95vw);
        height: min(560px, 84vh);
        border-radius: 28px;
        background: var(--card);
        border: 1px solid var(--stroke);
        box-shadow: var(--shadow);
        backdrop-filter: blur(10px);
        position: relative;
        overflow: hidden;
      }

      .content {
        position: relative;
        height: 100%;
        padding: 32px;
        display: flex;
        flex-direction: column;
        gap: 14px;
        text-align: center;
        align-items: center;
      }

      h1 {
        margin: 0;
        font-family: Fraunces, serif;
        font-weight: 900;
        font-size: clamp(42px, 5.2vw, 72px);
        letter-spacing: -1.2px;
        line-height: 1.02;
        color: var(--text);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        flex-wrap: wrap;
      }

      .titleIcon {
        width: 88px;
        height: 88px;
        display: inline-block;
        vertical-align: middle;
        transform: translateY(-4px);
        flex: 0 0 auto;
      }

      .titleIcon path,
      .titleIcon circle,
      .titleIcon line {
        vector-effect: non-scaling-stroke;
        stroke: rgba(255, 77, 143, 0.95);
        stroke-width: 2.2;
        stroke-linecap: round;
        stroke-linejoin: round;
        fill: transparent;
        transition:
          fill 900ms ease,
          filter 900ms ease,
          stroke 900ms ease;
      }

      body.love .titleIcon .hatFill {
        fill: rgba(255, 77, 143, 0.92);
        filter: drop-shadow(0 0 18px rgba(255, 77, 143, 0.25));
      }

      .subline {
        margin: 0;
        font-weight: 800;
        color: var(--muted);
        background: rgba(255, 255, 255, 0.55);
        border: 1px solid rgba(0, 0, 0, 0.06);
        padding: 10px 14px;
        border-radius: 14px;
        box-shadow: 0 12px 35px rgba(20, 10, 35, 0.1);
        width: min(760px, 95%);
        line-height: 1.5;
        font-size: 14px;
      }

      .arena {
        position: relative;
        width: 100%;
        flex: 1;
        border-radius: 22px;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.92),
          rgba(255, 255, 255, 0.82)
        );
        border: 1px solid rgba(0, 0, 0, 0.07);
        overflow: hidden;
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.45);
      }

      .arenaHearts {
        position: absolute;
        inset: -12%;
        pointer-events: none;
        opacity: 0.14;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='240' height='240' viewBox='0 0 240 240'%3E%3Cg fill='none' stroke='rgba(164,132,255,0.18)' stroke-width='8'%3E%3Cpath d='M120 182s-68-40-85-80c-11-25 4-55 33-60 19-3 38 5 52 22 14-17 33-25 52-22 29 5 44 35 33 60-17 40-85 80-85 80z'/%3E%3C/g%3E%3C/svg%3E");
        background-repeat: repeat;
        background-size: 240px 240px;
        animation: arenaDrift 12s ease-in-out infinite alternate;
      }
      @keyframes arenaDrift {
        from {
          transform: translate3d(-10px, -6px, 0);
        }
        to {
          transform: translate3d(10px, 8px, 0);
        }
      }

      .row {
        position: absolute;
        left: 50%;
        top: 58%;
        transform: translate(-50%, -50%);
        display: flex;
        gap: 18px;
        align-items: center;
        justify-content: center;
        padding: 0 18px;
        z-index: 2;
      }

      .btn {
        appearance: none;
        border: 1px solid rgba(0, 0, 0, 0.08);
        cursor: pointer;
        user-select: none;
        padding: 14px 20px;
        border-radius: 18px;
        font-weight: 900;
        letter-spacing: 0.4px;
        box-shadow: 0 18px 40px rgba(20, 10, 35, 0.14);
        transition:
          transform 180ms ease,
          filter 180ms ease,
          box-shadow 180ms ease;
        min-width: 138px;
        position: relative;
        transform-origin: center;
      }
      .btn:hover {
        transform: translateY(-2px);
      }
      .btn:active {
        transform: translateY(1px);
      }
      .btn:focus-visible {
        outline: 3px solid var(--ring);
        outline-offset: 2px;
      }

      #yesBtn {
        background: linear-gradient(
          135deg,
          var(--yes-primary),
          var(--yes-secondary)
        );
        color: white;
        box-shadow:
          0 18px 40px var(--yes-glow),
          0 4px 12px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      /* Small helper text under YES that appears as it grows */
      #yesHint {
        position: absolute;
        left: 50%;
        top: calc(58% + 70px);
        transform: translateX(-50%);
        z-index: 2;
        font-weight: 800;
        font-size: 13px;
        color: var(--muted);
        background: rgba(255, 255, 255, 0.66);
        border: 1px solid rgba(0, 0, 0, 0.06);
        padding: 8px 12px;
        border-radius: 999px;
        box-shadow: 0 12px 35px rgba(20, 10, 35, 0.1);
        opacity: 0;
        transition:
          opacity 200ms ease,
          transform 200ms ease;
        pointer-events: none;
        max-width: min(560px, 92%);
        text-align: center;
      }
      #yesHint.show {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }

      #noStatic {
        background: linear-gradient(
          135deg,
          var(--no-primary),
          var(--no-secondary)
        );
        color: white;
      }

      /* YES wings */
      .wing {
        position: absolute;
        top: 50%;
        width: 30px;
        height: 20px;
        border-radius: 999px;
        background: linear-gradient(135deg, #ffb3d9, #ffd6eb);
        filter: drop-shadow(0 10px 14px rgba(20, 10, 35, 0.14));
        transform: translateY(-50%);
        animation: flutter 1.15s ease-in-out infinite;
        opacity: 0.95;
        pointer-events: none;
        display: none;
        z-index: 3;
      }
      .wing.left {
        left: -14px;
        transform-origin: right center;
      }
      .wing.right {
        right: -14px;
        transform-origin: left center;
        animation-delay: 0.12s;
      }
      @keyframes flutter {
        0%,
        100% {
          transform: translateY(-50%) rotate(10deg) scaleX(1);
        }
        50% {
          transform: translateY(-50%) rotate(-14deg) scaleX(1.12);
        }
      }

      /* NO becomes global */
      .noWrap {
        position: fixed;
        left: 0;
        top: 0;
        transform: translate3d(0px, 0px, 0px);
        will-change: transform;
        z-index: 9998;
        display: none;
        pointer-events: auto;
      }

      .bird {
        position: relative;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        padding: 12px 16px;
        border-radius: 18px;
        background: linear-gradient(
          135deg,
          var(--no-primary),
          var(--no-secondary)
        );
        border: 1px solid rgba(0, 0, 0, 0.08);
        box-shadow: 0 18px 40px rgba(20, 10, 35, 0.14);
        font-weight: 900;
        color: white;
        letter-spacing: 0.4px;
        min-width: 138px;
        cursor: pointer;
        transition:
          transform 220ms ease,
          filter 220ms ease,
          opacity 180ms ease;
        transform: translateZ(0);
      }

      .bird .body {
        width: 22px;
        height: 14px;
        border-radius: 999px;
        background: linear-gradient(180deg, #22152e, #6b5a86);
        position: relative;
        margin-left: 2px;
      }
      .bird .eye {
        position: absolute;
        left: 6px;
        top: 3px;
        width: 4px;
        height: 4px;
        border-radius: 50%;
        background: #fff;
      }
      .bird .beak {
        position: absolute;
        right: -8px;
        top: 50%;
        transform: translateY(-50%);
        width: 0;
        height: 0;
        border-left: 10px solid #ffb84a;
        border-top: 6px solid transparent;
        border-bottom: 6px solid transparent;
      }

      .winglet {
        position: absolute;
        top: 50%;
        width: 26px;
        height: 18px;
        border-radius: 18px;
        background: linear-gradient(135deg, #22152e, #7b6a98);
        filter: drop-shadow(0 12px 14px rgba(20, 10, 35, 0.16));
        transform: translateY(-50%);
        pointer-events: none;
        opacity: 0.95;
        display: none;
      }
      .winglet.left {
        left: -14px;
        transform-origin: right center;
      }
      .winglet.right {
        right: -14px;
        transform-origin: left center;
      }

      .bird.wings .winglet {
        display: block;
      }
      .bird.wings .winglet.left {
        animation: flap 220ms ease-in-out infinite;
      }
      .bird.wings .winglet.right {
        animation: flap 220ms ease-in-out infinite;
        animation-delay: 110ms;
      }

      .bird.boost {
        filter: drop-shadow(0 18px 30px rgba(255, 77, 143, 0.12));
        transform: translateY(-2px) rotate(-1deg);
      }
      .bird.boost .winglet.left {
        animation-duration: 140ms;
      }
      .bird.boost .winglet.right {
        animation-duration: 140ms;
      }

      @keyframes flap {
        0%,
        100% {
          transform: translateY(-50%) rotate(18deg) scaleX(1.06);
        }
        50% {
          transform: translateY(-50%) rotate(-26deg) scaleX(0.9);
        }
      }

      /* Sparkle near YES */
      .spark {
        position: absolute;
        width: 9px;
        height: 9px;
        border-radius: 50%;
        background: radial-gradient(
          circle at 30% 30%,
          #fff,
          rgba(255, 255, 255, 0) 62%
        );
        filter: drop-shadow(0 0 10px rgba(255, 79, 163, 0.35));
        pointer-events: none;
        animation: pop 820ms ease-out forwards;
        opacity: 0.95;
        z-index: 1;
      }
      @keyframes pop {
        0% {
          transform: translate(-50%, -50%) scale(0.55);
          opacity: 0;
        }
        14% {
          opacity: 1;
        }
        100% {
          transform: translate(calc(-50% + var(--dx)), calc(-50% + var(--dy)))
            scale(0);
          opacity: 0;
        }
      }

      /* NO burst pieces */
      .noPiece {
        position: fixed;
        width: 10px;
        height: 10px;
        border-radius: 3px;
        pointer-events: none;
        z-index: 10000;
        box-shadow: 0 10px 22px rgba(20, 10, 35, 0.12);
        animation: noExplode var(--dur) cubic-bezier(0.12, 0.9, 0.22, 1)
          forwards;
        opacity: 0.98;
      }
      @keyframes noExplode {
        0% {
          transform: translate3d(var(--x), var(--y), 0) rotate(0deg) scale(1);
          opacity: 1;
        }
        100% {
          transform: translate3d(
              calc(var(--x) + var(--dx)),
              calc(var(--y) + var(--dy)),
              0
            )
            rotate(var(--rot)) scale(0.1);
          opacity: 0;
        }
      }

      .final {
        position: absolute;
        inset: 0;
        display: none;
        place-items: center;
        background: rgba(255, 240, 248, 0.55);
        backdrop-filter: blur(10px);
        z-index: 10;
      }
      .final.show {
        display: grid;
      }
      .final .box {
        width: min(620px, 92vw);
        padding: 22px;
        border-radius: 24px;
        background: rgba(255, 255, 255, 0.9);
        border: 1px solid rgba(0, 0, 0, 0.08);
        box-shadow: 0 28px 90px rgba(20, 10, 35, 0.18);
        text-align: center;
      }
      .final h2 {
        margin: 0 0 8px;
        font-family: Fraunces, serif;
        font-size: 30px;
        letter-spacing: -0.6px;
        color: #1b1029;
      }
      .final p {
        margin: 0;
        color: var(--muted2);
        font-weight: 800;
        line-height: 1.5;
      }
    </style>
  </head>

  <body>
    <div id="confettiLayer" aria-hidden="true"></div>
    <div class="heartsOutline" aria-hidden="true"></div>
    <div class="heartsFill" aria-hidden="true"></div>

    <div class="wrap">
      <div class="card">
        <div class="content">
          <h1>
            Shivangi, will you be mine?
            <!-- Chef hat icon (fills on YES) -->
            <svg class="titleIcon" viewBox="0 0 24 24" aria-hidden="true">
              <path
                class="hatFill"
                d="M7 11c-2.2 0-4-1.8-4-4s1.8-4 4-4c.6 0 1.2.1 1.7.4C9.6 2.5 10.8 2 12 2s2.4.5 3.3 1.4c.5-.3 1.1-.4 1.7-.4c2.2 0 4 1.8 4 4s-1.8 4-4 4"
              ></path>
              <path d="M6 11h12v2H6z"></path>
              <path d="M7 13v5c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2v-5"></path>
              <line x1="9" y1="16" x2="9" y2="18"></line>
              <line x1="12" y1="16" x2="12" y2="18"></line>
              <line x1="15" y1="16" x2="15" y2="18"></line>
            </svg>
          </h1>

          <p class="subline" id="afterLine">
            Chef Shivangi, I will bring the ring. You bring the magic.
          </p>

          <div class="arena" id="arena">
            <div class="arenaHearts" aria-hidden="true"></div>

            <div class="row" id="row">
              <button class="btn" id="yesBtn" type="button">
                YES
                <span class="wing left" aria-hidden="true"></span>
                <span class="wing right" aria-hidden="true"></span>
              </button>

              <button class="btn" id="noStatic" type="button">NO</button>
            </div>

            <div id="yesHint" aria-hidden="true"></div>

            <div class="final" id="final">
              <div class="box">
                <h2>Done. We are engaged. üíç</h2>
                <p>
                  Date locked: 19 February. <br />
                  Chef Shivangi, I promise unlimited taste tests and lifetime
                  dishwashing support.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- NO becomes global (outside card), fixed-position -->
    <div class="noWrap" id="noWrap"></div>

    <script>
      (function () {
        const arena = document.getElementById("arena");
        const noStatic = document.getElementById("noStatic");
        const noWrap = document.getElementById("noWrap");
        const yesBtn = document.getElementById("yesBtn");
        const yesHint = document.getElementById("yesHint");
        const afterLine = document.getElementById("afterLine");
        const final = document.getElementById("final");
        const confettiLayer = document.getElementById("confettiLayer");
        const yesWings = yesBtn.querySelectorAll(".wing");

        const witty = [
          "Chef mode: activated. Now select YES, please.",
          "No is currently being saut√©ed. Do not touch it.",
          "This kitchen only serves one answer: YES.",
        ];

        let chase = 0;
        let lastMoveAt = 0;
        let birdMode = false;
        let birdBtn = null;
        let locked = false;

        const lastMouse = { x: null, y: null };

        function setLine(t) {
          afterLine.textContent = t;
        }
        function clamp(v, min, max) {
          return Math.max(min, Math.min(max, v));
        }

        function sparkleAtYes(count) {
          const ar = arena.getBoundingClientRect();
          const yr = yesBtn.getBoundingClientRect();
          const x = yr.left - ar.left + yr.width / 2;
          const y = yr.top - ar.top + yr.height / 2;

          for (let i = 0; i < count; i++) {
            const s = document.createElement("div");
            s.className = "spark";
            s.style.left = x + "px";
            s.style.top = y + "px";
            const dx = (Math.random() * 2 - 1) * (28 + Math.random() * 32);
            const dy = (Math.random() * 2 - 1) * (18 + Math.random() * 44);
            s.style.setProperty("--dx", dx.toFixed(1) + "px");
            s.style.setProperty("--dy", dy.toFixed(1) + "px");
            arena.appendChild(s);
            setTimeout(() => s.remove(), 860);
          }
        }

        function confettiWholePage() {
          const palette = [
            "#ff4d8f",
            "#ff7aab",
            "#ffa3d5",
            "#a695c4",
            "#d4b5ff",
            "#ffffff",
            "#ffe16b",
            "#ffb84a",
          ];
          const pieces = 280;

          for (let i = 0; i < pieces; i++) {
            const c = document.createElement("div");
            c.className = "confetti";
            c.style.background =
              palette[Math.floor(Math.random() * palette.length)];

            const x = Math.random() * window.innerWidth;
            const y = -20 - Math.random() * 140;

            const dx = (Math.random() * 2 - 1) * 240;
            const dy = window.innerHeight + 300 + Math.random() * 260;
            const rot = (Math.random() * 2 - 1) * 900 + "deg";
            const dur = (2.0 + Math.random() * 1.3).toFixed(2) + "s";

            const w = 6 + Math.random() * 10;
            const h = 10 + Math.random() * 12;
            c.style.width = w.toFixed(1) + "px";
            c.style.height = h.toFixed(1) + "px";

            c.style.setProperty("--x", x.toFixed(1) + "px");
            c.style.setProperty("--y", y.toFixed(1) + "px");
            c.style.setProperty("--dx", dx.toFixed(1) + "px");
            c.style.setProperty("--dy", dy.toFixed(1) + "px");
            c.style.setProperty("--rot", rot);
            c.style.setProperty("--dur", dur);

            confettiLayer.appendChild(c);
            setTimeout(() => c.remove(), 3600);
          }
        }

        function maybeWitty() {
          if (chase === 3) return witty[0];
          if (chase === 5) return witty[1];
          if (chase === 7) return witty[2];
          return null;
        }

        function yesGrowMessage() {
          if (chase === 1)
            return "Shivangi‚Ä¶ look at YES growing. It is excited.";
          if (chase === 3)
            return "I am going to burst. Please choose YES, Chef.";
          if (chase === 5) return "Taste test: YES. Rating: 10/10.";
          if (chase === 7) return "Final plating: click YES.";
          if (chase === 9) return "Order up: YES, immediately.";
          return null;
        }

        function updateYesSize() {
          const scale = Math.min(1.0 + chase * 0.08, 1.85);
          yesBtn.style.transform = "scale(" + scale.toFixed(3) + ")";

          if (chase >= 7) {
            yesWings.forEach((w) => (w.style.display = "block"));
          } else {
            yesWings.forEach((w) => (w.style.display = "none"));
          }

          const msg = yesGrowMessage();
          if (msg) {
            yesHint.textContent = msg;
            yesHint.classList.add("show");
          } else if (chase === 0) {
            yesHint.textContent = "";
            yesHint.classList.remove("show");
          }
        }

        function ensureFlyingNo() {
          if (birdMode) return;
          birdMode = true;

          noStatic.style.visibility = "hidden";
          noWrap.style.display = "block";

          const bird = document.createElement("button");
          bird.type = "button";
          bird.className = "bird";
          bird.id = "birdBtn";
          bird.innerHTML = `
            NO
            <span class="body">
              <span class="eye"></span>
              <span class="beak"></span>
            </span>
            <span class="winglet left" aria-hidden="true"></span>
            <span class="winglet right" aria-hidden="true"></span>
          `;
          noWrap.appendChild(bird);
          birdBtn = bird;

          bird.addEventListener("click", (e) => {
            e.preventDefault();
            escapeNow(true);
          });

          const sr = noStatic.getBoundingClientRect();
          moveNoCenterTo(sr.left + sr.width / 2, sr.top + sr.height / 2, true);
        }

        function getNoSize() {
          const rect = noWrap.getBoundingClientRect();
          return { w: rect.width || 150, h: rect.height || 56 };
        }

        function getNoCenter() {
          const nr = noWrap.getBoundingClientRect();
          return {
            cx: nr.left + nr.width / 2,
            cy: nr.top + nr.height / 2,
          };
        }

        function moveNoCenterTo(centerX, centerY, instant) {
          const { w, h } = getNoSize();

          const minX = 12 + w / 2;
          const maxX = window.innerWidth - 12 - w / 2;
          const minY = 12 + h / 2;
          const maxY = window.innerHeight - 12 - h / 2;

          const cx = clamp(centerX, minX, maxX);
          const cy = clamp(centerY, minY, maxY);

          const px = cx - w / 2;
          const py = cy - h / 2;

          noWrap.style.transition = instant
            ? "none"
            : "transform 340ms cubic-bezier(.18,.90,.18,1)";
          noWrap.style.transform = "translate3d(" + px + "px," + py + "px,0)";
        }

        function wingFlash() {
          if (!birdBtn) return;
          birdBtn.classList.add("wings");
          birdBtn.classList.add("boost");
          setTimeout(() => {
            if (!birdBtn) return;
            birdBtn.classList.remove("boost");
          }, 260);
        }

        function burstNo() {
          if (!birdMode || !birdBtn) return;

          const nr = birdBtn.getBoundingClientRect();
          const cx = nr.left + nr.width / 2;
          const cy = nr.top + nr.height / 2;

          birdBtn.style.opacity = "0";
          birdBtn.style.transform = "scale(0.9)";

          const palette = [
            "#a695c4",
            "#8b7ba8",
            "#ff7aab",
            "#ff4d8f",
            "#ffffff",
            "#d4b5ff",
            "#ffb84a",
          ];
          const pieces = 52;

          for (let i = 0; i < pieces; i++) {
            const p = document.createElement("div");
            p.className = "noPiece";
            p.style.background =
              palette[Math.floor(Math.random() * palette.length)];

            const size = 6 + Math.random() * 10;
            p.style.width = size.toFixed(1) + "px";
            p.style.height =
              (size * (0.8 + Math.random() * 0.9)).toFixed(1) + "px";

            const dx = (Math.random() * 2 - 1) * (140 + Math.random() * 220);
            const dy = (Math.random() * 2 - 1) * (120 + Math.random() * 220);
            const rot = (Math.random() * 2 - 1) * 900 + "deg";
            const dur = (0.75 + Math.random() * 0.55).toFixed(2) + "s";

            p.style.setProperty("--x", (cx - size / 2).toFixed(1) + "px");
            p.style.setProperty("--y", (cy - size / 2).toFixed(1) + "px");
            p.style.setProperty("--dx", dx.toFixed(1) + "px");
            p.style.setProperty("--dy", dy.toFixed(1) + "px");
            p.style.setProperty("--rot", rot);
            p.style.setProperty("--dur", dur);

            document.body.appendChild(p);
            setTimeout(() => p.remove(), 1600);
          }

          setTimeout(() => {
            noWrap.innerHTML = "";
            noWrap.style.display = "none";
            birdBtn = null;
            birdMode = false;
          }, 260);
        }

        function escapeNow(force) {
          if (locked) return;

          const now = performance.now();
          if (!force && now - lastMoveAt < 240) return;
          lastMoveAt = now;

          ensureFlyingNo();

          chase += 1;

          updateYesSize();
          sparkleAtYes(3 + Math.min(6, chase));
          wingFlash();

          const growMsg = yesGrowMessage();
          if (growMsg) {
            setLine(growMsg);
          } else {
            const w = maybeWitty();
            if (w) setLine(w);
          }

          const { cx, cy } = getNoCenter();

          const mx =
            lastMouse.x == null ? window.innerWidth * 0.5 : lastMouse.x;
          const my =
            lastMouse.y == null ? window.innerHeight * 0.5 : lastMouse.y;

          const vx = cx - mx;
          const vy = cy - my;
          const mag = Math.max(1, Math.hypot(vx, vy));
          const ux = vx / mag;
          const uy = vy / mag;

          const dist = 260 + Math.random() * 220;

          const jitter = (Math.random() * 2 - 1) * 0.75;
          const cosA = Math.cos(jitter);
          const sinA = Math.sin(jitter);
          const rx = ux * cosA - uy * sinA;
          const ry = ux * sinA + uy * cosA;

          moveNoCenterTo(cx + rx * dist, cy + ry * dist, false);
        }

        window.addEventListener("mousemove", (e) => {
          lastMouse.x = e.clientX;
          lastMouse.y = e.clientY;

          if (!birdMode || locked) return;

          const { cx, cy } = getNoCenter();
          const dNo = Math.hypot(lastMouse.x - cx, lastMouse.y - cy);

          const trigger = 95;
          if (dNo < trigger) {
            escapeNow(false);
          }
        });

        noStatic.addEventListener("mouseenter", () => {
          if (locked) return;
          ensureFlyingNo();
          escapeNow(true);
        });

        yesBtn.addEventListener("click", () => {
          if (locked) return;
          locked = true;

          burstNo();

          document.body.classList.add("love");
          confettiWholePage();
          sparkleAtYes(20);
          final.classList.add("show");

          setLine("Best decision of the month. üíç");

          yesHint.textContent = "";
          yesHint.classList.remove("show");
        });

        updateYesSize();
        requestAnimationFrame(() => requestAnimationFrame(ensureFlyingNo));

        window.addEventListener("resize", () => {
          if (!birdMode || locked) return;
          const { cx, cy } = getNoCenter();
          moveNoCenterTo(cx, cy, true);
        });
      })();
    </script>
  </body>
</html>
